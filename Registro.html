<!DOCTYPE html>
<html lang="es">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>
        <title>Olimpiada Potosina de Informática</title>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
        <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
        <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
        <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.15.0/jquery.validate.min.js"></script>
        <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.15.0/additional-methods.min.js"></script>
        <script src="js/materialize.js"></script>
        <script src="js/init.js"></script>
        <script src="https://www.gstatic.com/firebasejs/3.6.7/firebase.js"></script>
        <script src="js/init_js.js"></script>
        <script src="https://www.google.com/recaptcha/api.js"></script>
    </head>
    <body>
        <nav class="black z-depth-3" role="navigation">
            <div class="nav-wrapper container">
                <a id="logo-container" href="https://olimpiada-potosina-de-informatica.github.io" class="brand-logo circle"><img class="circle z-depth-5" height="135" width="135" src="logo_opi.png"></a>
                <ul class="right hide-on-med-and-down">
                    <li><a class="teal-text" href="Registro">Registro</a></li>
                    <li><a class="teal-text" href="">Iniciar Sesión</a></li>
                </ul>
                <ul id="nav-mobile" class="side-nav">
                    <li><a href="Registro">Registro</a></li>
                    <li><a href="">Iniciar Sesión</a></li>
                </ul>
                <a href="" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
            </div>
        </nav>
        <div class="section center">
            <br><br><br>
            <div class="row">
                <div class="col s12 m12 l12 center teal z-depth-3 white-text">
                    <h4>Registro</h4>
                </div>
            </div>                        
        </div>
        <div class="container">
            <div class="row card-panel grey lighten-5 z-depth-1">
                <h4 class="col s12 m12 l12 center light">Registrate en la Olimpiada Potosina de Informática</h4>
                <div class="col s12 center">
                    <h6 id="ErrorMSG"></h6>
                </div>
                <form id="registro" name="registro" method="get">
                    <div class="input-field col s12 m12 l6">                        
                        <input id="xfirst_name" type="text" name="xfirst_name">
                        <label for="xfirst_name">Nombre(s)</label>
                    </div>                    
                    <div class="input-field col s12 m12 l6">
                        <input id="xlast_name" type="text" name="xlast_name">
                        <label for="xlast_name">Apellidos</label>
                    </div>                    
                    <div class="input-field col s12">
                        <input id="xemail" type="email" name="xemail">
                        <label for="xemail">Email</label>
                    </div>
                    <div class="input-field col s12">
                        <input id="xpassword" type="password" name="xpassword">
                        <label for="xpassword">Password</label>
                    </div>
                    <div class="input-field col s12">
                        <input id="xxpassword" type="password" name="xxpassword">
                        <label for="xxpassword">Confirma Password</label>
                    </div>
                    <div class="col s12 g-recaptcha" data-sitekey="6LdKzxIUAAAAAGSTcUzPI5LXQjuTTc_v0TlPxDa9"></div>
                    <div class="col s12 center">
                        <button id="btnsender" class="btn" type="submit">¡Enviar!</button>
                    </div>
                </form>                
            </div>
        </div>
        <script>
            $( "#registro" ).validate({
                debug: true,
                rules: {
                    xfirst_name: {
                        required: true,
                        minlength: 3
                    },
                    xlast_name: {
                        required: true,
                        minlength: 5
                    },
                    xemail: {
                        required: true,
                        email: true
                    },
                    xpassword: {
                        required: true,
                        minlength: 5
                    },
                    xxpassword: {
                        required: true,
                        minlength: 5,
                        equalTo: "#xpassword"
                    }
                },
                messages: {
                    xfirst_name:{
                        required: "Campo Requerido",
                        minlength: "Mínimo 3 Caracteres"
                    },
                    xlast_name:{
                        required: "Campo Requerido",
                        minlength: "Mínimo 5 Caracteres"
                    },
                    xemail: "Correo no Valido",
                    xpassword:{
                        required: "Campo Requerido",
                        minlength: "Mínimo 5 Caracteres"
                    },
                    xxpassword:{
                        required: "Campo Requerido",
                        equalTo: "La Contraseña no coincide"
                    }
                },
                errorElement : 'div',
                errorPlacement: function(error, element) {
                    var placement = $(element).data('error');
                    if (placement) {
                        $(placement).append(error)
                    } else {
                        error.insertAfter(element);
                    }
                },
                invalidHandler: function(event, validator){
                    var errors = validator.numberOfInvalids();
                    if (errors) {
                        $("#ErrorMSG").hide();
                        $("#ErrorMSG").html("Hay Errores");
                        $("#ErrorMSG").addClass("card-panel red lighten-2 z-depth-1 white-text");
                        $("#ErrorMSG").show();
                    }
                },
                submitHandler:function(form){
                    $("#ErrorMSG").hide();
                    firebase.auth().createUserWithEmailAndPassword($("#xemail").val(),$("#xpassword").val()).then(function(user){
                        Materialize.toast("¡Perfecto!",4000);
                        window.location.href = "https://olimpiada-potosina-de-informatica.github.io".delay(4000);
                    }).catch(function(error) {
                        var errorCode = error.code;
                        var errorMessage = error.message;
                        switch(errorCode){
                            case 'auth/email-already-in-use':
                                Materialize.toast("e-mail En Uso",4000);
                                break;
                            case: 'auth/invalid-email':
                                Materialize.toast("e-mail Invalido",4000);
                                break;
                            case 'auth/operation-not-allowed':
                                Materialize.toast("Operación Invalida",4000);
                                break;
                            case 'auth/weak-password':
                                Materialize.toast("La Contraseña Débil",4000);
                                break;
                            default:
                                Materialize.toast("Error De Comunicación",4000);
                                break;
                        }
                    });
                }
            });
            $( "#btnsender" ).click(function(){
            });
        </script>
        <footer class="page-footer teal">
            <div class="container">
                <div class="row">
                    <div class="col l8 s12">
                        <h5 class="white-text">Olimpiada Potosina de Informática</h5>
                        <p class="grey-text text-lighten-4">La OPI (Olimpiada Potosina de Informática) es un evento organizado gracias a la colaboración de diferentes entidades educativas del estado de san Luis potosí, de prácticamente todos los niveles; Con el claro objetivo de formar a los jóvenes y niños en las artes de la programación y prepararlos para torneos, abiertos y justas que involucren esta disciplina.</p>
                    </div>
                    <div class="col l4 s12">
                        <h5 class="white-text">Contacto</h5>
                        <ul><li><a class="white-text" href="#!">Comité de la Olimpiada Potosina de Informática</a></li></ul>
                    </div>
                </div>                
            </div>
            <div class="footer-copyright">
                <div class="container">
                </div>
            </div>
        </footer>        
    </body>
</html>